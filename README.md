# Model-based Detection of Software Discrimination

In this file, we presents the artifacts used in our paper, which provides a Framework for Analysing Individual Fairness based on Software Models. The artifacts include:

* the *UMLfair profile*.

*  A prototypical implementation that supports the generation of LTL claims that conform to Defenition 4.1 in our paper. 

* The inputs and the outputs of applying our proposed framework on three case studies namely, the Bank Services System based on a real case study, the Delivery Management System based on the incedent describtion of [Amazon's delivery-free service](https://www.bloomberg.com/graphics/2016-amazon-same-day/), and the Loan Management System based on [business process model](https://link.springer.com/chapter/10.1007/978-3-319-92901-9_19) from an [event log](https://www.win.tue.nl/bpi/doku.php?id=2012:challenge) recording the loan management process of a Dutch financial institute. 

# Recources

* **Profile: The UMLfair Profile:** https://github.com/confFair/project/blob/master/profile.zip
* **LTL claims generator:** https://github.com/confFair/project/blob/master/ClaimsExtraction.zip
* **Lunch configuration: The lucn configuration to the transformation tool hugo/RT:** https://github.com/confFair/project/blob/master/hugort.launch

* **Artifacts: The bank services system case study:** https://github.com/confFair/project/blob/master/BankServicesSystem.zip
* **Artifacts: The delivery management system case study:** https://github.com/confFair/project/blob/master/DeliveryManagementSystem.zip
* **Artifacts: The loan management system case study:** https://github.com/confFair/project/blob/master/LoanManagementSystem.zip

The artifacts of each each case study contains: 
* a (*.uml*) file: the UML model of the system annotated with the UMLfair profile.
* Two (*.xlsx*) files. The first is the dataset, which used to uncover proxies for protected characteristics. The second file is the proxies for the protected characteristics in the model, which is used as input for our LTL claims generator.  
* a (.pml) file: the result of transforming the UML into PROMELA by using the [Hugo/RT](https://www.informatik.uni-augsburg.de/en/chairs/swt/sse/hugort/) tool. 
* a (*.pdf*) file: provides the generated batches of claims together with their verifications results. The verifiaction results are the output of  the [SPIN](http://spinroot.com/spin/whatispin.html) model checker. 
* (*.trail*) files: counterexamples of violated LTL claims generated by the [SPIN](http://spinroot.com/spin/whatispin.html) model checker.

# Transforming UML models to PROMELA specifications
The uploaded (.zip) files of the cases studies include all the required artifacts for transforming the UML models to PROMELA specification. Each (.zip) file include a (.pml) file that shows the result of the transformation. In the following, we explain how the the (.pml) files can be generate using the transformation tool support Hugo/RT.  

## Prerequisite 
We recommend using [Eclipse, Modeling Tools distribution](https://www.eclipse.org/downloads/packages/release/neon/r/eclipse-modeling-tools). 
* install the transformation tool Hugo/RT to your desktop. Information on how to install Hugo/RT can be found from [here](https://www.informatik.uni-augsburg.de/en/chairs/swt/sse/hugort/). You can transform the UML models directly by using the Hugo/RT or via an Eclipse lunch configuration to Hugo/RT as follows.

* Open your Eclipse and create a new empty project and name it *hugoRT*.
* Extract one of (.zip) files of the uploaded case staudies above. Select the (.uml) file and copy it to the created *hugoRT* project in your Eclipse. In the *hugoRT* project change the name of copied UML file to *model.xml*
* Select Eclipse menu item Run→ External Tools → External Tools Configurations…
* Click on the *New Item* icon. Add a name to the created item, for example, *hugort*.
* In the main table, add the directory to java.exe in the location textbox. For example, in my computer, the directory is (**C:\Program Files\Java\jdk1.8.0_241\bin\java.exe**)
* In the working directory textbox, add the directory to the lib forlder of the installed hugo/RT on your desktop. For example, **C:\Users\anonymous\Desktop\hugort-0_8a\lib**.
* Copy and Paste the following lunch configuration to the arguments textbox and change the user name from *anonymous* to your user name: -jar C:/Users/anonymous/Desktop/hugort-0_8a/lib/hugort.jar -opromela=C:/Users/anonymous/workspace/hugort/model.pml C:/Users/an/workspace/hugort/model.xml

* Press *Run*. After running the *hugort* lunch file, you should see the console output informing you about the transformation process. The process should take a few milliseconds. The process is finished when the following line is printed to the console: *Writing Promela system to.....*

* The result of the transformatio is (.pml) file saved to the *hugoRT* project directory.

# Generating LTL claims
The uploaded [ClaimsExtraction.zip](https://github.com/confFair/project/blob/master/ClaimsExtraction.zip) file includes all the required artifacts for generating LTL claims based on the UML models that are annotated with the UMLfair profile.

## Prerequisite 
We recommend using [Eclipse, Modeling Tools distribution](https://www.eclipse.org/downloads/packages/release/neon/r/eclipse-modeling-tools).

## Performing the generation of LTL claims. 
To execute the generation of LTL claims from UML models annotated with the UMLfair profile, please follow the following instruction. 

* Import the project package [ClaimsExtraction.zip](https://github.com/confFair/project/blob/master/ClaimsExtraction.zip)  to your local Eclipse workspace.
* Right-click on the main class *"src/ltlGenerator/Generator.java"* → *Run As Java Application*. Our generator takes as inputs: First, a UML model saved as (.xml) file. Second, information of proxies saved in a (.xlsx) file. By default, our generator takes as input the *bankSystem.xml* and the *ProxyOfBankSystem.xlsx* files. 

* Changing the input (.xml) file: First, copy the name of one of the (.xml) files that are provided in *ClaimsExtraction → src → ltlGenerator* directory. Second, find line 47 in the *Generator.java* file (**File inputFile = new File(xmlPath+"\\bankSystem.xml");**) and replace the file name *"bankSystem"* with the name of the selected (.xml) file. 

* Changing the input (.xlsx) file: First, copy the name of the corresponding (.xlsx) file to the selected (.xml) file. The (.xlsx) files are provided in directly in the *ClaimsExtraction* directory. Second, find line 65 in the *Generator.java* file (**File myExcelBook=new File("ProxyOfBankSystem.xlsx");**) and replace the file name *"ProxyOfBankSystem"* with the name of the selected (.xlsx) file.

* After running the *Generator.java* file, you should see the console output informing you about the generation process. The process should take a few milliseconds. The process is finished when the following line is printed to the console: *Completed Successfully! Time[ms]: ...*. The time shows the time needed for generating the claims.

* The output of running the *Generator.java* file is a *Report.txt* file contains batches of LTL claims. The Report.txt file is saved in the *ClaimsExtraction* directory.
